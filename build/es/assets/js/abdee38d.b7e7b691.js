"use strict";(self.webpackChunkdsanchezcr=self.webpackChunkdsanchezcr||[]).push([[3307],{5801:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>n,metadata:()=>t,toc:()=>l});var s=r(5893),o=r(1151);const n={title:"Ahorro de costos con Azure para sus aplicaciones web",description:"aprenda a optimizar lo que paga en Azure por sus aplicaciones web con PaaS",slug:"cost-savings-with-azure",authors:["dsanchezcr"],tags:["Azure","Cost Savings","Web Apps","SQL Azure"],enableComments:!0,hide_table_of_contents:!0,image:"https://raw.githubusercontent.com/dsanchezcr/website/main/static/img/CostSavings/Automation.jpg",date:"2023-01-04T18:00"},i="Ahorro de costos con Azure para sus aplicaciones web",t={permalink:"/es/blog/cost-savings-with-azure",source:"@site/i18n/es/docusaurus-plugin-content-blog/2023-01-03-CostSavingAzure.mdx",title:"Ahorro de costos con Azure para sus aplicaciones web",description:"aprenda a optimizar lo que paga en Azure por sus aplicaciones web con PaaS",date:"2023-01-04T18:00:00.000Z",formattedDate:"4 de enero de 2023",tags:[{label:"Azure",permalink:"/es/blog/tags/azure"},{label:"Cost Savings",permalink:"/es/blog/tags/cost-savings"},{label:"Web Apps",permalink:"/es/blog/tags/web-apps"},{label:"SQL Azure",permalink:"/es/blog/tags/sql-azure"}],readingTime:4.35,hasTruncateMarker:!0,authors:[{name:"David Sanchez",url:"https://github.com/dsanchezcr",imageURL:"https://github.com/dsanchezcr.png",key:"dsanchezcr"}],frontMatter:{title:"Ahorro de costos con Azure para sus aplicaciones web",description:"aprenda a optimizar lo que paga en Azure por sus aplicaciones web con PaaS",slug:"cost-savings-with-azure",authors:["dsanchezcr"],tags:["Azure","Cost Savings","Web Apps","SQL Azure"],enableComments:!0,hide_table_of_contents:!0,image:"https://raw.githubusercontent.com/dsanchezcr/website/main/static/img/CostSavings/Automation.jpg",date:"2023-01-04T18:00"},unlisted:!1,prevItem:{title:"Lista los repositorios con sus tama\xf1os en Azure Repos",permalink:"/es/blog/list-azure-repos-with-sizes"},nextItem:{title:"Agregar pruebas de carga a los flujos de trabajo de CI/CD",permalink:"/es/blog/adding-load-testing-to-your-workflows"}},c={authorsImageUrls:[void 0]},l=[{value:"Introducci\xf3n",id:"introducci\xf3n",level:2},{value:"Soluci\xf3n",id:"soluci\xf3n",level:2},{value:"Escalar verticalmente o reducir verticalmente la aplicaci\xf3n web",id:"escalar-verticalmente-o-reducir-verticalmente-la-aplicaci\xf3n-web",level:3},{value:"Escalar verticalmente o reducir el SQL Azure",id:"escalar-verticalmente-o-reducir-el-sql-azure",level:3},{value:"Conclusi\xf3n",id:"conclusi\xf3n",level:2}];function u(e){const a={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.h2,{id:"introducci\xf3n",children:"Introducci\xf3n"}),"\n",(0,s.jsx)(a.p,{children:"Muchas de nuestras aplicaciones web hospedadas en Azure se crean sobre un servicio PaaS, como Azure App Service y SQL Azure. Estos servicios generalmente se facturan en funci\xf3n de la cantidad de recursos que consumen. Cuantos m\xe1s recursos consumen, m\xe1s pagamos. Sin embargo, hay algunas mejores pr\xe1cticas que podemos seguir para reducir la cantidad de recursos consumidos y, por lo tanto, reducir la cantidad de dinero que pagamos. Especialmente si estamos ejecutando una aplicaci\xf3n web que no se usa 24/7 o solo se usa durante el horario comercial en la misma zona horaria."}),"\n",(0,s.jsxs)(a.p,{children:["Uno de los principios de la computaci\xf3n en la nube es el ",(0,s.jsx)(a.strong,{children:"elasticidad"}),", lo que significa que podemos escalar hacia arriba o hacia abajo los recursos que consume nuestra aplicaci\xf3n en funci\xf3n de la demanda o el horario. Esta es una gran caracter\xedstica de la nube, pero debemos ser conscientes de las implicaciones de costos de esta caracter\xedstica. Si ampliamos nuestra aplicaci\xf3n para manejar un pico de tr\xe1fico, tambi\xe9n debemos reducir los recursos cuando el tr\xe1fico vuelva a la normalidad."]}),"\n",(0,s.jsx)(a.p,{children:"En el Servicio de aplicaciones de Azure tenemos dos formas de escalar verticalmente, verticalmente o abajo y escalar horizontalmente o entrar. Escalar hacia arriba o hacia abajo significa que podemos cambiar el tama\xf1o de la m\xe1quina virtual en la que se ejecuta nuestra aplicaci\xf3n. Escalar horizontalmente o en significa que podemos agregar o quitar m\xe1quinas virtuales de nuestra aplicaci\xf3n. Podemos escalar hacia arriba o hacia abajo y escalar hacia afuera o hacia adentro al mismo tiempo. Por ejemplo, podemos escalar verticalmente el tama\xf1o de las m\xe1quinas virtuales y agregar m\xe1s m\xe1quinas virtuales a nuestra aplicaci\xf3n."}),"\n",(0,s.jsx)(a.p,{children:"As\xed que si tenemos una Web App de producci\xf3n que no se utiliza 24/7, debemos considerar lo siguiente:"}),"\n",(0,s.jsxs)(a.ul,{children:["\n",(0,s.jsx)(a.li,{children:"Reduzca la aplicaci\xf3n y la base de datos a los recursos m\xednimos necesarios durante las horas de menor actividad."}),"\n",(0,s.jsxs)(a.li,{children:["Escale verticalmente la aplicaci\xf3n y la base de datos a los recursos m\xe1ximos necesarios durante las horas punta. (Adem\xe1s, debemos habilitar el escalado autom\xe1tico para escalar horizontalmente la aplicaci\xf3n y agregar m\xe1s instancias cuando sea necesario, ",(0,s.jsx)(a.a,{href:"https://learn.microsoft.com/azure/azure-monitor/autoscale/autoscale-get-started?toc=%2Fazure%2Fapp-service%2Ftoc.json#create-your-first-autoscale-setting?WT.mc_id=DT-MVP-5005361",children:"a trav\xe9s de las reglas que defina para escalar horizontalmente o en"}),"."]}),"\n"]}),"\n",(0,s.jsx)(a.p,{children:"El proceso de escalado vertical y vertical se puede reducir manualmente desde el portal, como se muestra en la imagen."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{src:"/img/CostSavings/AzurePortal-ScaleUp.jpg",alt:""})}),"\n",(0,s.jsx)(a.p,{children:"Sin embargo, este proceso puede ser tedioso y propenso a errores. Podemos automatizar el proceso para escalar hacia arriba y hacia abajo la aplicaci\xf3n web y la base de datos durante la noche y los fines de semana. Esto reducir\xe1 la cantidad de recursos consumidos y, por lo tanto, reducir\xe1 la cantidad de dinero que pagamos."}),"\n",(0,s.jsx)(a.h2,{id:"soluci\xf3n",children:"Soluci\xf3n"}),"\n",(0,s.jsxs)(a.p,{children:["Podemos utilizar ",(0,s.jsx)(a.a,{href:"https://learn.microsoft.com/azure/automation/overview?WT.mc_id=DT-MVP-5005361",children:"Automatizaci\xf3n de Azure"})," para programar un script de PowerShell para reducir la escala de la aplicaci\xf3n web y la base de datos durante la noche y los fines de semana. Tambi\xe9n podemos programar otro script de PowerShell para escalar verticalmente la aplicaci\xf3n web y la base de datos antes del horario comercial."]}),"\n",(0,s.jsxs)(a.blockquote,{children:["\n",(0,s.jsxs)(a.p,{children:["Deber\xe1 configurar una identidad asignada por el sistema a la cuenta de Azure Automation para conectarse con los recursos de Azure. Puede seguir los pasos de este ",(0,s.jsx)(a.a,{href:"https://learn.microsoft.com/azure/automation/learn/powershell-runbook-managed-identity#assign-permissions-to-managed-identities?WT.mc_id=DT-MVP-5005361",children:"art\xedculo"}),"."]}),"\n"]}),"\n",(0,s.jsx)(a.p,{children:"Exploremos los scripts de PowerShell que podemos usar:"}),"\n",(0,s.jsx)(a.h3,{id:"escalar-verticalmente-o-reducir-verticalmente-la-aplicaci\xf3n-web",children:"Escalar verticalmente o reducir verticalmente la aplicaci\xf3n web"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-powershell",children:'$resourceGroupName = \'<Your Resource Group>\'\r\n$appServicePlanName = \'<Your App Service>\'\r\n$tier = \'<Tier you would like to scale down - For example: Basic>\'\r\ntry\r\n{\r\n    filter timestamp {"[$(Get-Date -Format G)]: $_"}\r\n    Write-Output "Script started." | timestamp\r\n    Write-Verbose "Logging in to Azure..." -Verbose\r\n    Connect-AzAccount -Identity\r\n    Write-Verbose "Login sucessful. Proceding to update service plan..." -Verbose\r\n    Set-AzAppServicePlan -ResourceGroupName $resourceGroupName -Name $appServicePlanName -tier $tier\r\n    Write-Verbose "Service plan updated. Getting information about the update..." -Verbose\r\n    $appPlanService = Get-AzAppServicePlan -ResourceGroupName $resourceGroupName -Name $appServicePlanName\r\n    Write-Output "App Service Plan name: $($appPlanService.Name)" | timestamp\r\n    Write-Output "Current App Service Plan status: $($appPlanService.Status), tier: $($appPlanService.Sku.Name)" | timestamp\r\n    Write-Output "Script finished."\r\n}\r\ncatch {\r\n    Write-Verbose "Error... \'$_.Exception\'" -Verbose\r\n    Write-Error -Message $_.Exception\r\n    throw $_.Exception\r\n}\n'})}),"\n",(0,s.jsx)(a.h3,{id:"escalar-verticalmente-o-reducir-el-sql-azure",children:"Escalar verticalmente o reducir el SQL Azure"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-powershell",children:'$resourceGroupName = \'<Your Resource Group>\'\r\n$SqlServerName = \'<Your SQL Azure Server Name>\'\r\n$DatabaseName = \'<Your SQL Azure DB Name>\'\r\n$Edition = \'<Tier you would like to scale down - For example: Basic>\'\r\n$PerfLevel = \'<Tier you would like to scale down - For example: Basic>\'\r\ntry{\r\n    filter timestamp {"[$(Get-Date -Format G)]: $_"}\r\n    Write-Output "Script started." | timestamp\r\n    Write-Verbose "Logging in to Azure..." -Verbose\r\n    Connect-AzAccount -Identity  \r\n    Write-Verbose "Login sucessful. Proceding to update SQL Server plan..." -Verbose\r\n    Set-AzSqlDatabase -ResourceGroupName $resourceGroupName -DatabaseName $DatabaseName -ServerName $SqlServerName -Edition $Edition -RequestedServiceObjectiveName $PerfLevel \r\n    Write-Verbose "SQL Server plan updated. Getting information about the update..." -Verbose\r\n    $sqlServerPlan = Get-AzSqlDatabase -ResourceGroupName $resourceGroupName -DatabaseName $DatabaseName -ServerName $SqlServerName\r\n    Write-Output "SQL Server Edition: $($sqlServerPlan.Edition)" | timestamp\r\n    Write-Output "Current SQL Server Plan status: $($sqlServerPlan.Status)" | timestamp\r\n    Write-Output "Script finished."\r\n}\r\ncatch{\r\n    Write-Verbose "Error... \'$_.Exception\'" -Verbose\r\n    Write-Error -Message $_.Exception\r\n    throw $_.Exception\r\n}\n'})}),"\n",(0,s.jsx)(a.p,{children:"Una vez creados los Runbooks en Automatizaci\xf3n de Azure, puede crear las programaciones y vincularlas a las programaciones."}),"\n",(0,s.jsx)(a.p,{children:(0,s.jsx)(a.img,{src:"/img/CostSavings/Automation.jpg",alt:""})}),"\n",(0,s.jsx)(a.h2,{id:"conclusi\xf3n",children:"Conclusi\xf3n"}),"\n",(0,s.jsx)(a.p,{children:"Hemos visto c\xf3mo podemos usar Azure Automation y PowerShell para programar el escalado vertical o vertical de la aplicaci\xf3n web y SQL Azure. Esto nos ayudar\xe1 a ahorrar dinero y tambi\xe9n a evitar el tiempo de inactividad durante el horario comercial al agregar los recursos que no usamos por la noche."})]})}function d(e={}){const{wrapper:a}={...(0,o.a)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},1151:(e,a,r)=>{r.d(a,{Z:()=>t,a:()=>i});var s=r(7294);const o={},n=s.createContext(o);function i(e){const a=s.useContext(n);return s.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function t(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),s.createElement(n.Provider,{value:a},e.children)}}}]);