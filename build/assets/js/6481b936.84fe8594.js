"use strict";(self.webpackChunkdsanchezcr=self.webpackChunkdsanchezcr||[]).push([[8753],{2022:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>u});var n=i(5893),o=i(1151);const s={title:"Building a simple contact form",description:"In this post, we will build a contact form with Azure Functions and Azure Communication Services.",slug:"building-a-contact-form-with-azure",authors:["dsanchezcr"],tags:["Azure Functions","GitHub Actions","Azure Communication Services","Azure Static Web Apps"],enableComments:!0,hide_table_of_contents:!0,image:"https://raw.githubusercontent.com/dsanchezcr/website/main/static/img/BuiltContactForm/ContactForm.jpg",date:"2023-04-23T18:00"},c="Building a simple contact form with Azure",r={permalink:"/blog/building-a-contact-form-with-azure",source:"@site/blog/2023-04-23-BuildContactForm.mdx",title:"Building a simple contact form",description:"In this post, we will build a contact form with Azure Functions and Azure Communication Services.",date:"2023-04-23T18:00:00.000Z",formattedDate:"April 23, 2023",tags:[{label:"Azure Functions",permalink:"/blog/tags/azure-functions"},{label:"GitHub Actions",permalink:"/blog/tags/git-hub-actions"},{label:"Azure Communication Services",permalink:"/blog/tags/azure-communication-services"},{label:"Azure Static Web Apps",permalink:"/blog/tags/azure-static-web-apps"}],readingTime:4.105,hasTruncateMarker:!0,authors:[{name:"David Sanchez",url:"https://github.com/dsanchezcr",email:"dsanchezcr@outlook.com",imageURL:"https://github.com/dsanchezcr.png",key:"dsanchezcr"}],frontMatter:{title:"Building a simple contact form",description:"In this post, we will build a contact form with Azure Functions and Azure Communication Services.",slug:"building-a-contact-form-with-azure",authors:["dsanchezcr"],tags:["Azure Functions","GitHub Actions","Azure Communication Services","Azure Static Web Apps"],enableComments:!0,hide_table_of_contents:!0,image:"https://raw.githubusercontent.com/dsanchezcr/website/main/static/img/BuiltContactForm/ContactForm.jpg",date:"2023-04-23T18:00"},unlisted:!1,prevItem:{title:"Verified Commits in GitHub",permalink:"/blog/verified-commits-in-github"},nextItem:{title:"Azure DevOps to GitHub \u2013 Repo Migration",permalink:"/blog/azure-devops-to-github-repo-migration"}},a={authorsImageUrls:[void 0]},u=[{value:"Introduction",id:"introduction",level:2},{value:"Why Azure Functions?",id:"why-azure-functions",level:2},{value:"What is Azure Communication Service?",id:"what-is-azure-communication-service",level:2},{value:"Building the Contact Form using Azure Functions and Azure Communication Service",id:"building-the-contact-form-using-azure-functions-and-azure-communication-service",level:2},{value:"1. Create the Azure resources",id:"1-create-the-azure-resources",level:4},{value:"2. Configure the Azure Communication Services - Email Service",id:"2-configure-the-azure-communication-services---email-service",level:4},{value:"3. Develop the Azure Function",id:"3-develop-the-azure-function",level:4},{value:"4. Develop the front end",id:"4-develop-the-front-end",level:4},{value:"5. GitHub Actions to build and deploy the solution",id:"5-github-actions-to-build-and-deploy-the-solution",level:4},{value:"Testing the solution",id:"testing-the-solution",level:2}];function l(e){const t={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"In this post, we will build a contact form with Azure Functions and Azure Communication Services."}),"\n",(0,n.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,n.jsx)(t.p,{children:"Having a functional contact form on your website is essential. A contact form is a simple yet effective way to receive inquiries and feedback from your visitors, customers, or clients. In this blog post, I will share my experience in building a contact form using Azure Functions and Azure Communication Service's Email Service."}),"\n",(0,n.jsx)(t.h2,{id:"why-azure-functions",children:"Why Azure Functions?"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/azure/azure-functions/functions-overview?WT.mc_id=DT-MVP-5005361",children:"Azure Functions"})," is a serverless computing service offered by Microsoft Azure. It allows developers to build, run, and scale applications without having to manage infrastructure. Azure Functions support multiple programming languages, including C#, Java, JavaScript, Python, and PowerShell."]}),"\n",(0,n.jsx)(t.p,{children:"In this case my website is running on a static web app, so I need to use a serverless solution to build the contact form. Azure Functions is a great option because it allows me to build a contact form without having to manage infrastructure or worry about the complexities of communication protocols."}),"\n",(0,n.jsx)(t.h2,{id:"what-is-azure-communication-service",children:"What is Azure Communication Service?"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/azure/communication-services/overview?WT.mc_id=DT-MVP-5005361",children:"Azure Communication Service"})," is a communication platform offered by Microsoft Azure. It provides developers with the tools and services to integrate real-time communication features such as voice, video, chat, and SMS messaging into their applications. Azure Communication Service also offers an ",(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/azure/communication-services/concepts/email/email-overview",children:"Email Service"})," that allows developers to send and receive emails programmatically."]}),"\n",(0,n.jsx)(t.h2,{id:"building-the-contact-form-using-azure-functions-and-azure-communication-service",children:"Building the Contact Form using Azure Functions and Azure Communication Service"}),"\n",(0,n.jsx)(t.p,{children:"To build a contact form using Azure Functions and Azure Communication Service's Email Service, I followed these steps:"}),"\n",(0,n.jsx)(t.h4,{id:"1-create-the-azure-resources",children:"1. Create the Azure resources"}),"\n",(0,n.jsx)(t.p,{children:"The first step was to create the Azure resources. These are the resouces that I used in this sample application:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?WT.mc_id=DT-MVP-5005361",children:"Azure Communication Service"})," - to manage the Email service."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/azure/communication-services/quickstarts/email/create-email-communication-resource?WT.mc_id=DT-MVP-5005361",children:"Azure Email Service (Part of Azure Communication Service)"})," - to send emails."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/azure/azure-functions/functions-create-first-function-vs-code?pivots=programming-language-csharp?WT.mc_id=DT-MVP-5005361",children:"Azure Function"})," - to process the HTTP trigger sent by the HTML and send the emails using Azure Communication Service."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/azure/static-web-apps/getting-started?WT.mc_id=DT-MVP-5005361",children:"Azure Static Web App"})," - to host the website (Index.html in this case)."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(2298).Z+"",width:"1487",height:"638"})}),"\n",(0,n.jsx)(t.h4,{id:"2-configure-the-azure-communication-services---email-service",children:"2. Configure the Azure Communication Services - Email Service"}),"\n",(0,n.jsx)(t.p,{children:"The next step was to configure the Azure Communication Services - Email Service. This includes setting up an email address to send emails. When you create this service you can choose if you want to use an Azure subdomain or if you want to setup your own domain."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(3865).Z+"",width:"891",height:"755"})}),"\n",(0,n.jsx)(t.p,{children:"In this case, I used the email address provisioned by an Azure subdomain."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(4832).Z+"",width:"1470",height:"466"})}),"\n",(0,n.jsx)(t.p,{children:"The email address was created and configured automatically:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(2225).Z+"",width:"1470",height:"518"})}),"\n",(0,n.jsx)(t.h4,{id:"3-develop-the-azure-function",children:"3. Develop the Azure Function"}),"\n",(0,n.jsx)(t.p,{children:"The first step was to create an Azure Function. You can choose from various templates based on the programming language of your choice. In this case, I used the VS Code to create the C# Azure Function with a HTTP trigger. The Function sends two emails, one to notify the website owner and another one to notify the user who sends the message through the website to let me know that their message was sent."}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsxs)(t.p,{children:["To call the Azure Function, it is required to send three parameters: ",(0,n.jsx)(t.code,{children:"name"}),", ",(0,n.jsx)(t.code,{children:"email"}),", and ",(0,n.jsx)(t.code,{children:"message"}),".\r\nAlso, the Function is using three environment variables that you need to create in the Azure Function configuration:"]}),"\n"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"myEmailAddress"}),": to notify the website owner that a new message has been received."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"senderEmailAddress"}),": the email address that was provisioned in the Azure Communication Service configuration."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"AzureCommunicationServicesConnectionString"}),": the connection string that was provisioned in the Azure Communication Service configuration."]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.a,{href:"https://learn.microsoft.com/dotnet/api/azure.communication.email.emailclient?view=azure-dotnet&WT.mc_id=DT-MVP-5005361",children:"EmailClient"})," class is used to send emails using the Azure Communication Service Email Service and it is initialized with the connection string."]}),"\n",(0,n.jsx)(t.p,{children:"The following code snippet shows the HTTP trigger function:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-c",metastring:'reference title="Azure Function HTTP Trigger - SendEmails.cs"',children:"https://github.com/dsanchezcr/ContactFormWithAzure/blob/9f619eb2c8d41e45574557dbf3c2f95486391d30/api/SendEmails.cs#L17-L57\n"})}),"\n",(0,n.jsx)(t.h4,{id:"4-develop-the-front-end",children:"4. Develop the front end"}),"\n",(0,n.jsx)(t.p,{children:"In my case I created a simple HTML file and added the necessary form fields for the contact form, name, email, and message."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-html",metastring:'reference title="Form to send the email"',children:"https://github.com/dsanchezcr/ContactFormWithAzure/blob/9f619eb2c8d41e45574557dbf3c2f95486391d30/Index.html#L123-L137\n"})}),"\n",(0,n.jsx)(t.p,{children:"Here is the JavaScript code that I used to process the call to Azure Function:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",metastring:'reference title="JavaScript code to call the Azure Function"',children:"https://github.com/dsanchezcr/ContactFormWithAzure/blob/9f619eb2c8d41e45574557dbf3c2f95486391d30/Index.html#L8-L32\n"})}),"\n",(0,n.jsx)(t.h4,{id:"5-github-actions-to-build-and-deploy-the-solution",children:"5. GitHub Actions to build and deploy the solution"}),"\n",(0,n.jsx)(t.p,{children:"I created a GitHub Action to build and deploy the Azure Function and the website. The following code snippet shows the GitHub Action:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-yaml",metastring:'reference title="GitHub Action to build and deploy the solution"',children:"https://github.com/dsanchezcr/ContactFormWithAzure/blob/9f619eb2c8d41e45574557dbf3c2f95486391d30/.github/workflows/main_contactformwithazure.yml#L1-L45\n"})}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:"The GitHub Action is using two secrets that you need to configure:"}),"\n"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"AZUREAPPSERVICE_PUBLISHPROFILE"}),": the publish profile of the Azure Function."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.code,{children:"AZURE_STATIC_WEB_APPS_API_TOKEN"}),": the API token of the Azure Static Web App."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"testing-the-solution",children:"Testing the solution"}),"\n",(0,n.jsx)(t.p,{children:"I tested the solution by sending a message from the contact form. The following image shows the email that was sent to the website owner and the email that was sent to the user who posted the message."}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(4961).Z+"",width:"1728",height:"1078"})}),"\n",(0,n.jsxs)(t.p,{children:["You can try the solution ",(0,n.jsx)(t.a,{href:"https://purple-sky-05cd51e0f.3.azurestaticapps.net/Index.html",children:"here"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["And check out my production contact form ",(0,n.jsx)(t.a,{href:"https://dsanchezcr.com/contact",children:"here"}),"."]})]})}function d(e={}){const{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},3865:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/AzureEmailCommunicationService-df292601b0710d1521952e307bd06599.jpg"},2298:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/AzureResourceVisualizer-9c96dc82f12f1934c5265d8344d0b1fd.jpg"},4961:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/ContactFormResult-96f36d1004a5c52573bce7ad566885c6.jpg"},4832:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/DomainProvision-e4099e2182f85c83b33e904aca4c774d.jpg"},2225:(e,t,i)=>{i.d(t,{Z:()=>n});const n=i.p+"assets/images/EmailCommunicationService-844b1adb2f6bdb9fd44bd3a5bdd3ae85.jpg"},1151:(e,t,i)=>{i.d(t,{Z:()=>r,a:()=>c});var n=i(7294);const o={},s=n.createContext(o);function c(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:c(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);